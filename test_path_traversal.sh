#!/bin/bash

# –¢–µ—Å—Ç –∑–∞—â–∏—Ç—ã –æ—Ç Path Traversal –∞—Ç–∞–∫

BASE_URL="http://localhost:8000"

echo "üîí –¢–µ—Å—Ç–∏—Ä–æ–≤–∞–Ω–∏–µ –∑–∞—â–∏—Ç—ã –æ—Ç Path Traversal..."
echo ""

# –¢–µ—Å—Ç 1: –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ /etc/passwd
echo "1. –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ /etc/passwd:"
curl -s -w "Status: %{http_code}\n" "$BASE_URL/uploads/../../../etc/passwd"
echo ""

# –¢–µ—Å—Ç 2: –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º —Ñ–∞–π–ª–∞–º
echo "2. –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ —Å–∏—Å—Ç–µ–º–Ω—ã–º —Ñ–∞–π–ª–∞–º:"
curl -s -w "Status: %{http_code}\n" "$BASE_URL/uploads/../../../../../../etc/hosts"
echo ""

# –¢–µ—Å—Ç 3: –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ —á–µ—Ä–µ–∑ URL encoding
echo "3. –ü–æ–ø—ã—Ç–∫–∞ —á–µ—Ä–µ–∑ URL encoding:"
curl -s -w "Status: %{http_code}\n" "$BASE_URL/uploads/%2e%2e%2f%2e%2e%2fetc%2fpasswd"
echo ""

# –¢–µ—Å—Ç 4: –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –∫–æ–¥—É
echo "4. –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ –∏—Å—Ö–æ–¥–Ω–æ–º—É –∫–æ–¥—É:"
curl -s -w "Status: %{http_code}\n" "$BASE_URL/uploads/../main.go"
echo ""

# –¢–µ—Å—Ç 5: –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ .env —Ñ–∞–π–ª—É
echo "5. –ü–æ–ø—ã—Ç–∫–∞ –¥–æ—Å—Ç—É–ø–∞ –∫ .env —Ñ–∞–π–ª—É:"
curl -s -w "Status: %{http_code}\n" "$BASE_URL/uploads/../.env"
echo ""

# –¢–µ—Å—Ç 6: –ù–æ—Ä–º–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª—É (–¥–æ–ª–∂–µ–Ω —Ä–∞–±–æ—Ç–∞—Ç—å)
echo "6. –ù–æ—Ä–º–∞–ª—å–Ω—ã–π –¥–æ—Å—Ç—É–ø –∫ —Ñ–∞–π–ª—É:"
curl -s -w "Status: %{http_code}\n" "$BASE_URL/uploads/avatars/test.jpg"
echo ""

echo "‚úÖ –í—Å–µ –∑–∞–ø—Ä–æ—Å—ã –¥–æ–ª–∂–Ω—ã –≤–æ–∑–≤—Ä–∞—â–∞—Ç—å 403/404, –∫—Ä–æ–º–µ –ø–æ—Å–ª–µ–¥–Ω–µ–≥–æ"
echo "‚ùå –ï—Å–ª–∏ –∫–∞–∫–æ–π-—Ç–æ –∑–∞–ø—Ä–æ—Å –≤–µ—Ä–Ω—É–ª 200 - –µ—Å—Ç—å —É—è–∑–≤–∏–º–æ—Å—Ç—å!"